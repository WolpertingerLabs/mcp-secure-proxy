{
  "name": "Notion API",
  "description": "Notion API — pages, databases, blocks, users, search, and more. Auth is handled automatically via the NOTION_API_KEY environment variable (internal integration token). The Notion-Version header is set to 2022-06-28. Includes a poll ingestor that periodically searches for recently edited pages — use poll_events to retrieve them.",
  "docsUrl": "https://developers.notion.com/reference",
  "headers": {
    "Authorization": "Bearer ${NOTION_API_KEY}",
    "Notion-Version": "2022-06-28",
    "Content-Type": "application/json"
  },
  "secrets": {
    "NOTION_API_KEY": "${NOTION_API_KEY}"
  },
  "allowedEndpoints": [
    "https://api.notion.com/**"
  ],
  "ingestor": {
    "type": "poll",
    "poll": {
      "url": "https://api.notion.com/v1/search",
      "intervalMs": 60000,
      "method": "POST",
      "body": {
        "sort": {
          "direction": "descending",
          "timestamp": "last_edited_time"
        }
      },
      "responsePath": "results",
      "deduplicateBy": "id",
      "eventType": "page_updated"
    }
  },
  "testIngestor": {
    "description": "Executes a single search poll to verify Notion API access",
    "strategy": "poll_once",
    "request": {
      "method": "POST",
      "url": "https://api.notion.com/v1/search",
      "body": {"page_size": 1},
      "expectedStatus": [200]
    }
  },
  "listenerConfig": {
    "name": "Notion Poll Listener",
    "description": "Polls Notion for recently edited pages at a configurable interval.",
    "fields": [
      {
        "key": "intervalMs",
        "label": "Poll Interval (ms)",
        "description": "How often to check for new events, in milliseconds.",
        "type": "number",
        "default": 60000,
        "min": 10000,
        "max": 3600000,
        "group": "Connection"
      },
      {
        "key": "bufferSize",
        "label": "Buffer Size",
        "description": "Maximum number of events to keep in memory.",
        "type": "number",
        "default": 200,
        "min": 10,
        "max": 1000,
        "group": "Advanced"
      }
    ]
  },
  "testConnection": {
    "url": "https://api.notion.com/v1/users/me",
    "description": "Fetches the authenticated bot user"
  }
}
